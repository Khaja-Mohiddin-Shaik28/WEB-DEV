<!DOCTYPE html>
<html lang="en">
<%- include("./partials/head.ejs") %>

    <body>
        <%- include("./partials/nav.ejs") %>
            <h1 id="heading">Update Todos</h1>
            <div class="todo-form">
                <form class="todo-form-table" id="updateForm">
                    <label for="title">Title : </label>
                    <input type="text" name="title" id="title" value="<%= todo.title %>">
                    <label for="title">Description : </label>
                    <textarea name="description" id="description"> <%= todo.description %></textarea>
                    <button type="submit" id="submit" data-doc="<%= todo.id  %>">Submit</button>
                </form>
            </div>

            <script>
                const updateForm = document.querySelector("#updateForm");
                const button = document.querySelector("#submit")
                updateForm.addEventListener(
                    "submit",
                    async (event) => {
                        event.preventDefault();
                        const title = document.querySelector("#title").value;
                        const description = document.querySelector("#description").value;
                        const id = button.dataset.doc;
                        let result = await fetch(`/todos/pending/${id}`,
                            {
                                method: "PUT",
                                headers: {
                                    "Content-Type": "application/json"
                                },
                                body: JSON.stringify({ title, description })
                            }
                        )
                        let response = await result.json();
                        window.location.href = response.redirect;
                    }
                )
            </script>
    </body>

</html>